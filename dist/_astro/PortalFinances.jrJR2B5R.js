import{m as b,a as z}from"./session.gQbCuShR.js";import{_ as te}from"./_plugin-vue_export-helper.x3n3nnut.js";import{u as ne}from"./index.uyIfrnu3.js";import{d as se,o as re,c as ie,t as oe}from"./runtime-core.esm-bundler.PmGDys5A.js";let U=0,B=[];function ae(){return U+=1,()=>{if(U-=1,U===0){let e=B;B=[];for(let n of e)n()}}}const ue=0,le=1,L=10;let X=(e,n,t,i)=>(e.events=e.events||{},e.events[t+L]||(e.events[t+L]=i(c=>{e.events[t].reduceRight((u,d)=>(d(u),u),{shared:{},...c})})),e.events[t]=e.events[t]||[],e.events[t].push(n),()=>{let c=e.events[t],u=c.indexOf(n);c.splice(u,1),c.length||(delete e.events[t],e.events[t+L](),delete e.events[t+L])}),ce=(e,n)=>X(e,n,ue,t=>{let i=e.listen;return e.listen=c=>(!e.lc&&!e.starting&&(e.starting=!0,t(),delete e.starting),i(c)),()=>{e.listen=i}}),fe=(e,n)=>X(e,n,le,t=>{let i=e.off;return e.off=()=>{t(),i()},()=>{e.off=i}}),de=()=>({emit(e,...n){let t=this.events[e]||[];for(let i=0,c=t.length;i<c;i++)t[i](...n)},events:{},on(e,n){return this.events[e]?.push(n)||(this.events[e]=[n]),()=>{this.events[e]=this.events[e]?.filter(t=>n!==t)}}});const he=({cache:e=new Map,fetcher:n,...t}={})=>{const i=de();let c=!0;J("visibilitychange",()=>{c=!document.hidden,c&&i.emit(q)}),J("online",()=>i.emit(H));const u=new Map,d=new Map,T=new Map;let R={};const F=async([s,v],o,r,m)=>{var S;if(!c)return;const a=h=>{o.key===s&&(o.set(h),i.emit(P,s,h,!0))},f=()=>{a({...o.value,...W,promise:T.get(s)})},{dedupeTime:p=4e3,fetcher:O}={...r,...R},g=Q();if(T.has(s)){o.value.loading||f();return}if(!m){const h=e.get(s);h&&o.value.data!==h&&a({data:h,...w});const l=d.get(s);if(l&&l+p>g)return}const A=ae();try{const h=O(...v);d.set(s,g),T.set(s,h),f();const l=await h;e.set(s,l),a({data:l,...w}),d.set(s,Q())}catch(h){(S=r.onError)==null||S.call(r,h),a({data:o.value.data,error:h,...w})}finally{A(),T.delete(s)}},k=(s,{fetcher:v=n,...o}={})=>{const r=b({...w}),m={...t,...o,fetcher:v};r._=Z,r.invalidate=()=>{const{key:l}=r;l&&M(l)},r.mutate=l=>{const{key:_}=r;_&&I(_,l)};let S,a,f,p,O,g=[];ce(r,()=>{const l=!S;[O,S]=ve(s),p=O.subscribe(y=>{if(y){const[E,C]=y;r.key=E,F([E,C],r,m),a=E,f=C}else r.key=a=f=void 0,r.set({...w})});const _=O.get();_&&([a,f]=_,l&&A());const{refetchInterval:D=0,refetchOnFocus:j,refetchOnReconnect:ee}=m,N=()=>{a&&F([a,f],r,m)};D>0&&u.set(s,setInterval(N,D)),j&&g.push(i.on(q,N)),ee&&g.push(i.on(H,N)),g.push(i.on(G,y=>{a&&x(a,y)&&F([a,f],r,m,!0)}),i.on(P,(y,E,C)=>{a&&x(a,y)&&r.value!==E&&r.value.data!==E&&r.set(C?E:{data:E,...w})}))});const A=()=>{a&&f&&F([a,f],r,m)},h=r.listen;return r.listen=l=>{const _=h(l);return l(r.value),A(),_},fe(r,()=>{r.value={...w},S?.(),g.forEach(_=>_()),g=[],p?.();const l=u.get(s);l&&clearInterval(l)}),r},K=s=>{e.delete(s),d.delete(s)},V=(s,v)=>{for(const o of e.keys())x(o,s)&&v(o)},M=s=>{V(s,K),i.emit(G,s)},I=(s,v)=>{V(s,o=>{v===void 0?K(o):e.set(o,v)}),i.emit(P,s,v)};function $(s){const v=async r=>{var m;const S=R.fetcher??s,a=[];try{o.set({error:void 0,data:void 0,mutate:v,...W});const f=await S({data:r,invalidate:p=>{a.push(p)},getCacheUpdater:(p,O=!0)=>[g=>{I(p,g),O&&a.push(p)},e.get(p)]});return o.setKey("data",f),f}catch(f){(m=t?.onError)==null||m.call(t,f),o.setKey("error",f)}finally{o.setKey("loading",!1),a.forEach(M)}},o=b({mutate:v,...w});return o.mutate=v,o}return[k,$,{__unsafeOverruleSettings:s=>{console.warn("You should only use __unsafeOverruleSettings in test environment"),R=s},invalidateKeys:M,mutateCache:I}]};function Y(e){return typeof e=="string"||typeof e=="number"||e===!0}const ve=e=>{if(Y(e))return[z([""+e,[e]]),()=>{}];let n=z(null),t=[];const i=()=>{t.some(u=>u==null||u===!1)?n.set(null):n.set([t.join(""),t])},c=[];for(let u=0;u<e.length;u++){const d=e[u];Y(d)?t.push(d):c.push(d.subscribe(T=>{t[u]=pe(d)?d.value&&"data"in d.value?d.key:null:T,i()}))}return i(),[n,()=>c.forEach(u=>u())]};function pe(e){return e._===Z}const q=1,H=2,G=3,P=4,J=(e,n)=>{typeof window>"u"||addEventListener(e,n)},x=(e,n)=>Array.isArray(n)?n.includes(e):typeof n=="function"?n(e):e===n,Q=()=>new Date().getTime(),Z=Symbol(),W={loading:!0},w={loading:!1};function me({baseUrl:e,...n}){return he({fetcher:(...t)=>fetch([e,...t].join(""),n).then(i=>i.json())})}const[ge,Ae]=me({baseUrl:"https://zolosake-api.pages.dev"}),Se=ge(["/github/user"]),_e=se({setup(){return{user:ne(Se)}},computed:{test(){return this.user.loading?"Lade Finanzen":this.user.error?"Error":(console.log(this.user.data),"true dummy")}}});function Ee(e,n,t,i,c,u){return re(),ie("div",null,oe(e.test),1)}const Ce=te(_e,[["render",Ee]]);export{Ce as default};
